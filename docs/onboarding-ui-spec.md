# Onboarding Wizard UI Specification

**Generated by:** LLM Council (council-mkogh0tqrk4b)
**Date:** 2026-01-21
**Ranking:** Claude 3.5 Sonnet (unanimous winner)

---

## Overview

A 4-phase wizard that onboards business units into SuperChase OS. The agent does research first, then asks minimal questions.

## Component Architecture

```
src/components/onboarding/
├── OnboardingWizard.tsx        # Main container & phase router
├── ProgressBar.tsx             # 4-step phase indicator
├── phases/
│   ├── ResearchPhase.tsx       # Phase 1: Autonomous research
│   ├── ConfirmationPhase.tsx   # Phase 2: Review & correct
│   ├── GapFillingPhase.tsx     # Phase 3: Answer gaps only
│   └── CompletionPhase.tsx     # Phase 4: Summary & verify
├── components/
│   ├── ConfidenceIndicator.tsx # High/Medium/Low badges
│   ├── ResearchStep.tsx        # Individual research item
│   ├── EditableField.tsx       # Inline edit with confidence
│   └── SummaryCard.tsx         # Final results card
├── hooks/
│   └── useOnboarding.ts        # Centralized state
└── types/
    └── onboarding.types.ts     # TypeScript definitions
```

---

## Type Definitions

```typescript
// types/onboarding.types.ts

export type Phase = 'RESEARCH' | 'CONFIRM' | 'GAP_FILL' | 'COMPLETE';
export type ConfidenceLevel = 'high' | 'medium' | 'low';

export interface ResearchStep {
  id: string;
  label: string;
  status: 'pending' | 'loading' | 'complete' | 'error';
  source?: string;
}

export interface ResearchItem {
  field: string;
  label: string;
  value: string | null;
  confidence: ConfidenceLevel;
  source: string;
  editable: boolean;
}

export interface GapQuestion {
  id: string;
  question: string;
  field: string;
  options?: { label: string; value: string }[];
  required: boolean;
}

export interface OnboardingState {
  phase: Phase;
  businessName: string;
  businessId: string;
  researchSteps: ResearchStep[];
  researchedData: ResearchItem[];
  gaps: GapQuestion[];
  userAnswers: Record<string, string>;
  filesCreated: string[];
  progress: number;
  error: string | null;
}
```

---

## Main Container

```tsx
// OnboardingWizard.tsx
import { motion, AnimatePresence } from 'framer-motion';
import { useOnboarding } from '../hooks/useOnboarding';

export const OnboardingWizard = ({ businessName }: { businessName: string }) => {
  const { state, actions } = useOnboarding(businessName);

  return (
    <div className="min-h-screen bg-slate-900 p-4 md:p-8">
      <div className="max-w-2xl mx-auto">
        {/* Header */}
        <div className="mb-6">
          <h1 className="text-2xl font-bold text-white">
            Onboarding: {state.businessName}
          </h1>
          <p className="text-slate-400 mt-1">
            {getPhaseDescription(state.phase)}
          </p>
        </div>

        {/* Progress Bar */}
        <ProgressBar currentPhase={state.phase} />

        {/* Phase Content */}
        <div className="glass rounded-2xl p-6 mt-6">
          <AnimatePresence mode="wait">
            {state.phase === 'RESEARCH' && (
              <ResearchPhase
                steps={state.researchSteps}
                onComplete={actions.completeResearch}
              />
            )}
            {state.phase === 'CONFIRM' && (
              <ConfirmationPhase
                data={state.researchedData}
                onConfirm={actions.confirmData}
                onEdit={actions.updateField}
              />
            )}
            {state.phase === 'GAP_FILL' && (
              <GapFillingPhase
                questions={state.gaps}
                onSubmit={actions.submitGaps}
              />
            )}
            {state.phase === 'COMPLETE' && (
              <CompletionPhase
                filesCreated={state.filesCreated}
                businessId={state.businessId}
              />
            )}
          </AnimatePresence>
        </div>
      </div>
    </div>
  );
};

const getPhaseDescription = (phase: Phase): string => {
  const descriptions = {
    RESEARCH: 'Gathering information from web and internal sources...',
    CONFIRM: 'Review and correct the data we found',
    GAP_FILL: 'Answer a few questions to fill in the gaps',
    COMPLETE: 'Your business is ready to use!'
  };
  return descriptions[phase];
};
```

---

## Progress Bar

```tsx
// ProgressBar.tsx
import { motion } from 'framer-motion';
import { Search, CheckCircle, HelpCircle, Sparkles } from 'lucide-react';

const phases = [
  { key: 'RESEARCH', label: 'Research', icon: Search },
  { key: 'CONFIRM', label: 'Confirm', icon: CheckCircle },
  { key: 'GAP_FILL', label: 'Questions', icon: HelpCircle },
  { key: 'COMPLETE', label: 'Complete', icon: Sparkles },
];

export const ProgressBar = ({ currentPhase }: { currentPhase: Phase }) => {
  const currentIndex = phases.findIndex(p => p.key === currentPhase);

  return (
    <div className="flex items-center justify-between">
      {phases.map((phase, index) => {
        const Icon = phase.icon;
        const isActive = index === currentIndex;
        const isComplete = index < currentIndex;

        return (
          <div key={phase.key} className="flex items-center">
            {/* Step circle */}
            <motion.div
              className={`
                w-11 h-11 rounded-full flex items-center justify-center
                ${isComplete ? 'bg-green-500' : isActive ? 'bg-blue-500' : 'bg-slate-700'}
              `}
              animate={{ scale: isActive ? 1.1 : 1 }}
            >
              <Icon className="w-5 h-5 text-white" />
            </motion.div>

            {/* Label */}
            <span className={`
              ml-2 text-sm font-medium hidden sm:block
              ${isActive ? 'text-white' : 'text-slate-400'}
            `}>
              {phase.label}
            </span>

            {/* Connector line */}
            {index < phases.length - 1 && (
              <div className={`
                w-8 md:w-16 h-0.5 mx-2
                ${isComplete ? 'bg-green-500' : 'bg-slate-700'}
              `} />
            )}
          </div>
        );
      })}
    </div>
  );
};
```

---

## Phase 1: Research

```tsx
// phases/ResearchPhase.tsx
import { motion } from 'framer-motion';
import { Loader2, Check, X, Globe, FileText, Database } from 'lucide-react';

const stepIcons = {
  web: Globe,
  files: FileText,
  database: Database,
};

export const ResearchPhase = ({ steps, onComplete }) => {
  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      exit={{ opacity: 0, y: -20 }}
      className="space-y-4"
    >
      <h2 className="text-xl font-semibold text-white mb-6">
        Researching Your Business
      </h2>

      <div className="space-y-3">
        {steps.map((step, index) => (
          <motion.div
            key={step.id}
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: index * 0.1 }}
            className="flex items-center gap-4 p-4 bg-slate-800/50 rounded-lg"
          >
            {/* Status icon */}
            <div className="w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center">
              {step.status === 'loading' && (
                <Loader2 className="w-5 h-5 text-blue-400 animate-spin" />
              )}
              {step.status === 'complete' && (
                <Check className="w-5 h-5 text-green-400" />
              )}
              {step.status === 'error' && (
                <X className="w-5 h-5 text-red-400" />
              )}
              {step.status === 'pending' && (
                <div className="w-2 h-2 bg-slate-500 rounded-full" />
              )}
            </div>

            {/* Label */}
            <div className="flex-1">
              <p className={`font-medium ${
                step.status === 'complete' ? 'text-white' : 'text-slate-400'
              }`}>
                {step.label}
              </p>
              {step.source && (
                <p className="text-xs text-slate-500 mt-0.5">
                  {step.source}
                </p>
              )}
            </div>
          </motion.div>
        ))}
      </div>

      {/* Progress bar */}
      <div className="mt-6 h-2 bg-slate-700 rounded-full overflow-hidden">
        <motion.div
          className="h-full bg-blue-500"
          initial={{ width: '0%' }}
          animate={{
            width: `${(steps.filter(s => s.status === 'complete').length / steps.length) * 100}%`
          }}
          transition={{ duration: 0.5 }}
        />
      </div>
    </motion.div>
  );
};
```

---

## Phase 2: Confirmation

```tsx
// phases/ConfirmationPhase.tsx
import { motion } from 'framer-motion';
import { ConfidenceIndicator } from '../components/ConfidenceIndicator';
import { EditableField } from '../components/EditableField';

export const ConfirmationPhase = ({ data, onConfirm, onEdit }) => {
  // Group by confidence
  const highConfidence = data.filter(d => d.confidence === 'high');
  const needsReview = data.filter(d => d.confidence !== 'high');

  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      exit={{ opacity: 0, y: -20 }}
      className="space-y-6"
    >
      <h2 className="text-xl font-semibold text-white">
        Review Research Results
      </h2>

      {/* High confidence section */}
      {highConfidence.length > 0 && (
        <div className="space-y-3">
          <h3 className="text-sm font-medium text-green-400 uppercase tracking-wide">
            Verified Information
          </h3>
          {highConfidence.map(item => (
            <EditableField
              key={item.field}
              item={item}
              onEdit={onEdit}
            />
          ))}
        </div>
      )}

      {/* Needs review section */}
      {needsReview.length > 0 && (
        <div className="space-y-3">
          <h3 className="text-sm font-medium text-yellow-400 uppercase tracking-wide">
            Please Verify
          </h3>
          {needsReview.map(item => (
            <EditableField
              key={item.field}
              item={item}
              onEdit={onEdit}
              highlighted
            />
          ))}
        </div>
      )}

      {/* Confirm button */}
      <button
        onClick={onConfirm}
        className="w-full py-4 bg-blue-600 hover:bg-blue-500
                   text-white font-semibold rounded-xl
                   min-h-[44px] transition-colors"
      >
        Confirm & Continue
      </button>
    </motion.div>
  );
};
```

---

## Confidence Indicator

```tsx
// components/ConfidenceIndicator.tsx
import { CheckCircle, AlertCircle, HelpCircle } from 'lucide-react';

const config = {
  high: {
    bg: 'bg-green-500/20',
    text: 'text-green-400',
    icon: CheckCircle,
    label: 'High'
  },
  medium: {
    bg: 'bg-yellow-500/20',
    text: 'text-yellow-400',
    icon: AlertCircle,
    label: 'Medium'
  },
  low: {
    bg: 'bg-red-500/20',
    text: 'text-red-400',
    icon: HelpCircle,
    label: 'Low'
  }
};

export const ConfidenceIndicator = ({ level }: { level: ConfidenceLevel }) => {
  const { bg, text, icon: Icon, label } = config[level];

  return (
    <span className={`
      inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full
      text-xs font-medium ${bg} ${text}
    `}>
      <Icon className="w-3 h-3" />
      {label}
    </span>
  );
};
```

---

## Editable Field

```tsx
// components/EditableField.tsx
import { useState } from 'react';
import { motion } from 'framer-motion';
import { Pencil, Check, X } from 'lucide-react';
import { ConfidenceIndicator } from './ConfidenceIndicator';

export const EditableField = ({ item, onEdit, highlighted = false }) => {
  const [editing, setEditing] = useState(false);
  const [value, setValue] = useState(item.value || '');

  const handleSave = () => {
    onEdit(item.field, value);
    setEditing(false);
  };

  return (
    <motion.div
      className={`
        p-4 rounded-xl border transition-colors
        ${highlighted
          ? 'bg-yellow-500/5 border-yellow-500/30'
          : 'bg-slate-800/50 border-slate-700'
        }
      `}
      layout
    >
      <div className="flex items-start justify-between gap-4">
        <div className="flex-1">
          <div className="flex items-center gap-2 mb-1">
            <label className="text-sm font-medium text-slate-300">
              {item.label}
            </label>
            <ConfidenceIndicator level={item.confidence} />
          </div>

          {editing ? (
            <div className="flex items-center gap-2 mt-2">
              <input
                type="text"
                value={value}
                onChange={(e) => setValue(e.target.value)}
                className="flex-1 px-3 py-2 bg-slate-700 border border-slate-600
                           rounded-lg text-white min-h-[44px]
                           focus:outline-none focus:ring-2 focus:ring-blue-500"
                autoFocus
              />
              <button
                onClick={handleSave}
                className="p-2 bg-green-600 rounded-lg min-w-[44px] min-h-[44px]
                           flex items-center justify-center"
              >
                <Check className="w-5 h-5 text-white" />
              </button>
              <button
                onClick={() => setEditing(false)}
                className="p-2 bg-slate-600 rounded-lg min-w-[44px] min-h-[44px]
                           flex items-center justify-center"
              >
                <X className="w-5 h-5 text-white" />
              </button>
            </div>
          ) : (
            <p className="text-white">
              {item.value || <span className="text-slate-500 italic">Not found</span>}
            </p>
          )}

          {item.source && !editing && (
            <p className="text-xs text-slate-500 mt-1">
              Source: {item.source}
            </p>
          )}
        </div>

        {!editing && item.editable && (
          <button
            onClick={() => setEditing(true)}
            className="p-2 hover:bg-slate-700 rounded-lg transition-colors
                       min-w-[44px] min-h-[44px] flex items-center justify-center"
          >
            <Pencil className="w-4 h-4 text-slate-400" />
          </button>
        )}
      </div>
    </motion.div>
  );
};
```

---

## Phase 3: Gap Filling

```tsx
// phases/GapFillingPhase.tsx
import { useState } from 'react';
import { motion } from 'framer-motion';

export const GapFillingPhase = ({ questions, onSubmit }) => {
  const [answers, setAnswers] = useState<Record<string, string>>({});

  const handleAnswer = (questionId: string, value: string) => {
    setAnswers(prev => ({ ...prev, [questionId]: value }));
  };

  const allAnswered = questions
    .filter(q => q.required)
    .every(q => answers[q.id]);

  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      exit={{ opacity: 0, y: -20 }}
      className="space-y-6"
    >
      <div>
        <h2 className="text-xl font-semibold text-white">
          Just {questions.length} Quick Questions
        </h2>
        <p className="text-slate-400 mt-1">
          Research couldn't find these - your input is needed
        </p>
      </div>

      <div className="space-y-4">
        {questions.map((question, index) => (
          <motion.div
            key={question.id}
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: index * 0.1 }}
            className="p-4 bg-slate-800/50 rounded-xl"
          >
            <label className="block text-white font-medium mb-3">
              {question.question}
              {question.required && (
                <span className="text-red-400 ml-1">*</span>
              )}
            </label>

            {question.options ? (
              <div className="grid grid-cols-2 gap-2">
                {question.options.map(option => (
                  <button
                    key={option.value}
                    onClick={() => handleAnswer(question.id, option.value)}
                    className={`
                      p-3 rounded-lg text-left transition-all
                      min-h-[44px] border
                      ${answers[question.id] === option.value
                        ? 'bg-blue-600 border-blue-500 text-white'
                        : 'bg-slate-700 border-slate-600 text-slate-300 hover:border-slate-500'
                      }
                    `}
                  >
                    {option.label}
                  </button>
                ))}
              </div>
            ) : (
              <input
                type="text"
                value={answers[question.id] || ''}
                onChange={(e) => handleAnswer(question.id, e.target.value)}
                placeholder="Type your answer..."
                className="w-full px-4 py-3 bg-slate-700 border border-slate-600
                           rounded-lg text-white min-h-[44px]
                           focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            )}
          </motion.div>
        ))}
      </div>

      <button
        onClick={() => onSubmit(answers)}
        disabled={!allAnswered}
        className={`
          w-full py-4 font-semibold rounded-xl min-h-[44px]
          transition-colors
          ${allAnswered
            ? 'bg-blue-600 hover:bg-blue-500 text-white'
            : 'bg-slate-700 text-slate-500 cursor-not-allowed'
          }
        `}
      >
        Complete Onboarding
      </button>
    </motion.div>
  );
};
```

---

## Phase 4: Completion

```tsx
// phases/CompletionPhase.tsx
import { motion } from 'framer-motion';
import { CheckCircle, FileJson, ExternalLink, Sparkles } from 'lucide-react';

export const CompletionPhase = ({ filesCreated, businessId }) => {
  return (
    <motion.div
      initial={{ opacity: 0, scale: 0.95 }}
      animate={{ opacity: 1, scale: 1 }}
      className="text-center space-y-6"
    >
      {/* Success icon */}
      <motion.div
        initial={{ scale: 0 }}
        animate={{ scale: 1 }}
        transition={{ type: 'spring', delay: 0.2 }}
        className="w-20 h-20 mx-auto bg-green-500/20 rounded-full
                   flex items-center justify-center"
      >
        <Sparkles className="w-10 h-10 text-green-400" />
      </motion.div>

      <div>
        <h2 className="text-2xl font-bold text-white">
          Onboarding Complete!
        </h2>
        <p className="text-slate-400 mt-2">
          {businessId} is now ready for AI-powered automation
        </p>
      </div>

      {/* Files created */}
      <div className="bg-slate-800/50 rounded-xl p-4 text-left">
        <h3 className="text-sm font-medium text-slate-400 uppercase tracking-wide mb-3">
          Files Created
        </h3>
        <div className="space-y-2">
          {filesCreated.map((file, index) => (
            <motion.div
              key={file}
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.3 + index * 0.1 }}
              className="flex items-center gap-3 text-sm"
            >
              <FileJson className="w-4 h-4 text-blue-400" />
              <span className="text-slate-300 font-mono">{file}</span>
              <CheckCircle className="w-4 h-4 text-green-400 ml-auto" />
            </motion.div>
          ))}
        </div>
      </div>

      {/* Context injection status */}
      <div className="bg-blue-500/10 border border-blue-500/30 rounded-xl p-4">
        <p className="text-blue-400 text-sm">
          <strong>Context Injection Ready</strong><br />
          The LLM Council will now use @{businessId} data automatically
        </p>
      </div>

      {/* Actions */}
      <div className="flex gap-3">
        <button
          onClick={() => window.location.href = `/dashboard/clients/${businessId}`}
          className="flex-1 py-3 bg-blue-600 hover:bg-blue-500
                     text-white font-medium rounded-xl
                     min-h-[44px] transition-colors
                     flex items-center justify-center gap-2"
        >
          View Dashboard
          <ExternalLink className="w-4 h-4" />
        </button>
        <button
          onClick={() => window.location.href = '/onboard'}
          className="flex-1 py-3 bg-slate-700 hover:bg-slate-600
                     text-white font-medium rounded-xl
                     min-h-[44px] transition-colors"
        >
          Onboard Another
        </button>
      </div>
    </motion.div>
  );
};
```

---

## Custom Hook

```typescript
// hooks/useOnboarding.ts
import { useState, useCallback, useEffect } from 'react';
import { OnboardingState, Phase, ResearchItem } from '../types/onboarding.types';

const initialState: OnboardingState = {
  phase: 'RESEARCH',
  businessName: '',
  businessId: '',
  researchSteps: [],
  researchedData: [],
  gaps: [],
  userAnswers: {},
  filesCreated: [],
  progress: 0,
  error: null,
};

export const useOnboarding = (businessName: string) => {
  const [state, setState] = useState<OnboardingState>({
    ...initialState,
    businessName,
    businessId: businessName.toLowerCase().replace(/\s+/g, ''),
  });

  // Start research on mount
  useEffect(() => {
    startResearch();
  }, []);

  const startResearch = async () => {
    const steps = [
      { id: 'web', label: 'Searching web...', status: 'loading' },
      { id: 'internal', label: 'Checking internal data...', status: 'pending' },
      { id: 'limitless', label: 'Loading business intelligence...', status: 'pending' },
    ];

    setState(prev => ({ ...prev, researchSteps: steps }));

    // Simulate research steps (replace with real API calls)
    for (let i = 0; i < steps.length; i++) {
      await new Promise(resolve => setTimeout(resolve, 2000));
      setState(prev => ({
        ...prev,
        researchSteps: prev.researchSteps.map((s, idx) => ({
          ...s,
          status: idx === i ? 'complete' : idx === i + 1 ? 'loading' : s.status,
        })),
      }));
    }

    // Fetch actual research results from API
    const response = await fetch(`/api/onboard/research?name=${encodeURIComponent(businessName)}`);
    const data = await response.json();

    setState(prev => ({
      ...prev,
      phase: 'CONFIRM',
      researchedData: data.researched,
      gaps: data.gaps,
    }));
  };

  const updateField = useCallback((field: string, value: string) => {
    setState(prev => ({
      ...prev,
      researchedData: prev.researchedData.map(item =>
        item.field === field ? { ...item, value, confidence: 'high' } : item
      ),
    }));
  }, []);

  const confirmData = useCallback(() => {
    setState(prev => ({
      ...prev,
      phase: prev.gaps.length > 0 ? 'GAP_FILL' : 'COMPLETE',
    }));
  }, []);

  const submitGaps = useCallback(async (answers: Record<string, string>) => {
    // Save to API
    const response = await fetch('/api/onboard/complete', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        businessId: state.businessId,
        businessName: state.businessName,
        researchedData: state.researchedData,
        answers,
      }),
    });

    const result = await response.json();

    setState(prev => ({
      ...prev,
      phase: 'COMPLETE',
      filesCreated: result.filesCreated,
      userAnswers: answers,
    }));
  }, [state.businessId, state.businessName, state.researchedData]);

  return {
    state,
    actions: {
      updateField,
      confirmData,
      submitGaps,
      completeResearch: () => setState(prev => ({ ...prev, phase: 'CONFIRM' })),
    },
  };
};
```

---

## API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/onboard/research` | GET | Trigger research for business name |
| `/api/onboard/complete` | POST | Save configs and complete onboarding |

---

## Tailwind Configuration

Add to `tailwind.config.js`:

```javascript
module.exports = {
  theme: {
    extend: {
      // Glass morphism utility
      backdropBlur: {
        glass: '16px',
      },
    },
  },
  plugins: [],
};
```

Add `.glass` class to globals:

```css
.glass {
  @apply bg-slate-800/50 backdrop-blur-xl border border-slate-700/50;
}
```

---

## Responsive Breakpoints

| Breakpoint | Behavior |
|------------|----------|
| Mobile (< 640px) | Single column, icons only in progress bar |
| Tablet (640-1024px) | Full progress bar with labels |
| Desktop (> 1024px) | Wider container, more padding |

---

## Accessibility

- All buttons have `min-h-[44px]` for touch targets
- Form inputs have visible focus states
- Color is not the only indicator (icons + text for confidence)
- Motion respects `prefers-reduced-motion`

---

## Implementation Priority

1. **Phase 1**: Types + useOnboarding hook + basic shell
2. **Phase 2**: ResearchPhase with animations
3. **Phase 3**: ConfirmationPhase with EditableField
4. **Phase 4**: GapFillingPhase + CompletionPhase
5. **Phase 5**: API integration + error handling
